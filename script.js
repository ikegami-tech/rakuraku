/* --- ★重要: GASの最新デプロイURLに書き換えてください --- */
const API_URL = "https://script.google.com/macros/s/AKfycby5VLs0rwSnZk8fah8jrb-iCI3HMpi7KxggEK_83QuX64K9kCB-BovDd2Nu0tHg3r3S/exec";
// ▼▼▼ ここにBase64コードを貼り付けます ▼▼▼

// 7階の画像（以前の画像コードをこの引用符の中に貼り付け）
const IMG_7F = "data:image/png;base64,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BA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACA7gQMAyE7gAACyEzgAgOwEDgAgO4EDAMhO4AAAshM4AIDsBA4AIDuBAwDITuAAALITOACA7AQOACC7/w8wLc6pjU6UMQAAAABJRU5ErkJggg=="; 

// 6階の画像（新しい画像コードをこの引用符の中に貼り付け）
const IMG_6F = "data:image/png;base64,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";

// ▲▲▲ 貼り付けここまで ▲▲▲
const START_HOUR = 9;
const END_HOUR = 19;
// CSSの設定と合わせる（基準高さ）
const BASE_HOUR_HEIGHT = 50; 

let currentUser = null;
let masterData = { rooms: [], users: [], reservations: [], logs: [], groups: [] };
let selectedParticipantIds = new Set();
let originalParticipantIds = new Set();
let currentMapRoomId = null; 

window.onload = () => {
  document.getElementById('timeline-date').valueAsDate = new Date();
  document.getElementById('search-date').valueAsDate = new Date();
  document.getElementById('map-date').valueAsDate = new Date();
};

async function callAPI(params) {
  if(API_URL.indexOf("http") === -1) { alert("GASのURLを設定してください"); return; }
  document.getElementById('loading').style.display = 'flex';
  const options = { method: 'POST', body: JSON.stringify(params), headers: { 'Content-Type': 'text/plain;charset=utf-8' } };
  try {
    const res = await fetch(API_URL, options);
    if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
    const json = await res.json();
    document.getElementById('loading').style.display = 'none';
    if (json.status === 'error') { alert("システムエラー: " + json.message); return { status: 'error' }; }
    return json;
  } catch(e) {
    document.getElementById('loading').style.display = 'none';
    alert("通信エラー: " + e.message);
    return { status: 'error' };
  }
}

async function tryLogin() {
  const id = document.getElementById('loginId').value.trim();
  const pass = document.getElementById('loginPass').value.trim();
  if(!id || !pass) return;
  document.getElementById('loading').style.display = 'flex';
  
  const url = new URL(API_URL);
  url.searchParams.append('action', 'login');
  url.searchParams.append('userId', id);
  url.searchParams.append('password', pass);
  try {
    const res = await fetch(url.toString(), { method: 'GET', headers: { 'Content-Type': 'text/plain;charset=utf-8' } });
    const json = await res.json();
    document.getElementById('loading').style.display = 'none';
    if (json.status === 'success') {
      currentUser = json.user;
      document.getElementById('display-user-name').innerText = currentUser.userName;
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('app-screen').style.display = 'flex'; 
      loadAllData();
    } else { alert("ログイン失敗: " + json.message); }
  } catch (e) {
    document.getElementById('loading').style.display = 'none';
    alert("通信エラー: " + e.message);
  }
}

function logout() { location.reload(); }

async function loadAllData() {
  document.getElementById('loading').style.display = 'flex';
  const url = new URL(API_URL);
  url.searchParams.append('action', 'getAllData');
  url.searchParams.append('_t', new Date().getTime()); 
  
  try {
    const res = await fetch(url.toString(), { method: 'GET', headers: { 'Content-Type': 'text/plain;charset=utf-8' } });
    const json = await res.json();
    document.getElementById('loading').style.display = 'none';
    if (json.status === 'success') {
      masterData = json.data;
      initUI();
    } else { 
      alert("読込エラー: " + json.message); 
    }
  } catch(e) { 
    document.getElementById('loading').style.display = 'none'; 
  }
}

function initUI() {
  const searchSelect = document.getElementById('search-room-select');
  const currentSearchRoomId = searchSelect.value;

  renderTimeAxis('time-axis-all');
  renderTimeAxis('time-axis-single');
  renderTimeAxis('time-axis-map');
  
  const roomSelects = [document.getElementById('input-room'), searchSelect];
  roomSelects.forEach(sel => {
    sel.innerHTML = "";
    masterData.rooms.forEach(r => {
      const op = document.createElement('option');
      op.value = r.roomId;
      op.innerText = r.roomName;
      sel.appendChild(op);
    });
  });

  if (currentSearchRoomId) {
      searchSelect.value = currentSearchRoomId;
  }

  renderVerticalTimeline('all');
  renderLogs();
  
  if (document.getElementById('view-room-search').classList.contains('active')) {
      renderRoomSearch();
  }
  
  renderGroupButtons();
}

function renderGroupButtons() {
  const container = document.getElementById('group-buttons-area');
  container.innerHTML = "";
  if (!masterData.groups || masterData.groups.length === 0) return;
  masterData.groups.forEach(grp => {
      const btn = document.createElement('div');
      btn.className = 'group-chip';
      btn.innerText = `+ ${grp.groupName}`;
      btn.onclick = () => selectGroupMembers(grp.memberIds);
      container.appendChild(btn);
  });
}

function selectGroupMembers(idsStr) {
  if (!idsStr) return;
  const rawIds = idsStr.split(',');
  const targetUsers = [];
  rawIds.forEach(rawId => {
      const cleanIdStr = rawId.trim();
      const user = masterData.users.find(u => String(u.userId) === cleanIdStr);
      if (user) { targetUsers.push(user); }
  });
  if (targetUsers.length === 0) return;

  const isAllSelected = targetUsers.every(u => selectedParticipantIds.has(String(u.userId)));
  if (isAllSelected) {
      targetUsers.forEach(u => selectedParticipantIds.delete(String(u.userId)));
  } else {
      targetUsers.forEach(u => selectedParticipantIds.add(String(u.userId)));
  }
  renderShuttleLists(document.getElementById('shuttle-search-input').value);
}

function renderShuttleLists(filterText = "") {
  const leftList = document.getElementById('list-candidates');
  const rightList = document.getElementById('list-selected');
  leftList.innerHTML = "";
  rightList.innerHTML = "";

  masterData.users.forEach(u => {
      if (!u.userId) return;
      const uidStr = String(u.userId);

      if (selectedParticipantIds.has(uidStr)) {
          const div = document.createElement('div');
          div.className = 'shuttle-item icon-remove';
          div.innerText = u.userName;
          div.onclick = () => {
              selectedParticipantIds.delete(uidStr);
              renderShuttleLists(document.getElementById('shuttle-search-input').value);
          };
          rightList.appendChild(div);
      } else {
          if (filterText === "" || u.userName.toLowerCase().includes(filterText.toLowerCase())) {
              const div = document.createElement('div');
              div.className = 'shuttle-item icon-add';
              div.innerText = u.userName;
              div.onclick = () => {
                  selectedParticipantIds.add(uidStr);
                  renderShuttleLists(document.getElementById('shuttle-search-input').value);
              };
              leftList.appendChild(div);
          }
      }
  });
}

function switchTab(tabName) {
  document.querySelectorAll('.view-container').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
  
  document.getElementById('view-' + tabName).classList.add('active');
  
  const tabs = document.querySelectorAll('.nav-item');
  // インデックスが変わる可能性があるので、クラス名やロジックで判定したほうが安全ですが
  // 簡易的に以下のように変更します
  if(tabName==='map-view') tabs[0].classList.add('active'); // 新規追加
  if(tabName==='timeline') tabs[1].classList.add('active');
  if(tabName==='room-search') { tabs[2].classList.add('active'); renderRoomSearch(); }
  if(tabName==='logs') tabs[3].classList.add('active');
}

let hourRowHeights = {}; 

function drawTimeAxis(containerId) {
  const container = document.getElementById(containerId);
  const children = Array.from(container.children);
  children.forEach(child => {
      if(!child.classList.contains('time-axis-header')) container.removeChild(child);
  });

  for (let i = START_HOUR; i < END_HOUR; i++) {
      const height = hourRowHeights[i] || BASE_HOUR_HEIGHT;
      const div = document.createElement('div');
      div.className = 'time-label';
      div.innerText = i + ":00";
      div.style.height = height + "px";
      container.appendChild(div);
  }
}

function renderTimeAxis(containerId) {
    // 初期化時は何もしない
}

// ▼▼▼ 修正版 renderVerticalTimeline (script.js) ▼▼▼
function renderVerticalTimeline(mode) {
  let container, dateInputId, targetRooms;
  let timeAxisId;

  if (mode === 'all') {
      container = document.getElementById('rooms-container-all');
      dateInputId = 'timeline-date';
      timeAxisId = 'time-axis-all';
      targetRooms = masterData.rooms;
   } else if (mode === 'map') { // ★ここを追加
      container = document.getElementById('rooms-container-map');
      dateInputId = 'map-date';
      timeAxisId = 'time-axis-map';
      // マップで選択中の部屋IDを使う
      targetRooms = masterData.rooms.filter(r => String(r.roomId) === String(currentMapRoomId));
      container.style.width = "100%";
  }  else {
      container = document.getElementById('rooms-container-single');
      dateInputId = 'search-date';
      timeAxisId = 'time-axis-single';
      const selectedId = document.getElementById('search-room-select').value;
      targetRooms = masterData.rooms.filter(r => r.roomId === selectedId);
      container.style.width = "100%"; 
  }
  
  if (!targetRooms || targetRooms.length === 0) {
      container.innerHTML = "<div style='padding:20px;'>部屋データが見つかりません。</div>";
      return;
  }

  const rawDateVal = document.getElementById(dateInputId).value; 
  const targetDateNum = formatDateToNum(new Date(rawDateVal)); 
  
  // 1. 高さ計算配列を初期化
  for(let h=START_HOUR; h<END_HOUR; h++) hourRowHeights[h] = BASE_HOUR_HEIGHT;

  // ▼▼▼ 【追加修正】画面幅に合わせて1行の文字数を自動計算する ▼▼▼
  // コンテナの幅を取得（非表示などで0の場合はウィンドウ幅を使う）
  const totalWidth = container.clientWidth > 0 ? container.clientWidth : window.innerWidth;
  const colCount = targetRooms.length > 0 ? targetRooms.length : 1;
  
  // 1列あたりの幅 (CSSの min-width: 120px を考慮しつつ、平均幅を算出)
  let colWidth = Math.floor(totalWidth / colCount);
  if (colWidth < 120) colWidth = 120;

  // 1行に入る文字数の概算
  // フォントサイズ11px + 余白等を考慮して、1文字あたり約12px幅と仮定
  // (列幅 - 左右パディング約10px) / 12px
  let calculatedChars = Math.floor((colWidth - 10) / 12);
  if (calculatedChars < 12) calculatedChars = 12; // 最低でも12文字基準は維持

  // この値を後続の計算で使用
  const DYNAMIC_CHARS_PER_LINE = calculatedChars;
  // ▲▲▲ 追加ここまで ▲▲▲

  const allRelevantReservations = masterData.reservations.filter(res => {
      const startTimeVal = getVal(res, ['startTime', 'start_time', '開始日時', '開始', 'Start']);
      if (!startTimeVal) return false;

      const rId = getVal(res, ['resourceId', 'roomId', 'room_id', 'resource_id', '部屋ID', '部屋']);
      const isTargetRoom = targetRooms.some(r => String(r.roomId) === String(rId));
      const resDateNum = formatDateToNum(new Date(startTimeVal));
      
      res._startTime = startTimeVal;
      res._endTime = getVal(res, ['endTime', 'end_time', '終了日時', '終了', 'End']);
      res._resourceId = rId;

      return isTargetRoom && (resDateNum === targetDateNum);
  });

  // 2. 高さ自動計算
  allRelevantReservations.forEach(res => {
      const start = new Date(res._startTime);
      const sHour = start.getHours();
      
      let displayText = getVal(res, ['title', 'subject', '件名', 'タイトル']) || '予約';
      let namesText = "";
      
      const pIdsStr = getVal(res, ['participantIds', 'participant_ids', '参加者', 'メンバー']);
      if (pIdsStr) {
          const resIds = String(pIdsStr).split(',').map(id => id.trim()).sort();
          const matchedGroup = masterData.groups.find(grp => {
              if (!grp.memberIds) return false;
              const grpIds = grp.memberIds.split(',').map(id => id.trim()).sort();
              return JSON.stringify(resIds) === JSON.stringify(grpIds);
          });
          if (matchedGroup) {
              namesText = matchedGroup.groupName;
          } else {
              const names = resIds.map(id => {
                  const u = masterData.users.find(user => {
                      const uIdStr = String(user.userId);
                      return uIdStr === id || (!isNaN(uIdStr) && !isNaN(id) && Number(uIdStr) === Number(id));
                  });
                  return u ? u.userName : "";
              }).filter(n => n);
              namesText = names.join(', ');
          }
      }

      // --- 【修正】文字数見積もり ---
      // 自動計算した文字数を使用する（これで幅広のときは行数が減り、余白が消えます）
      const CHARS_PER_LINE = DYNAMIC_CHARS_PER_LINE; 
      
      const titleLines = Math.ceil(displayText.length / CHARS_PER_LINE) || 1;
      const timeLines = 1; // 時間表示
      const nameLines = namesText ? Math.ceil(namesText.length / CHARS_PER_LINE) : 0;
      
      // 合計行数
      const totalLines = titleLines + timeLines + nameLines; 
      
      // --- 高さ計算 ---
      const contentHeightPx = (totalLines * 15) + 10;

      // --- 時間比率による拡張 ---
      let durationMin = (new Date(res._endTime) - new Date(res._startTime)) / 60000;
      if (durationMin < 15) durationMin = 15;
      
      const ratio = durationMin / 60;
      const requiredHourHeight = contentHeightPx / ratio;
      
      if (sHour >= START_HOUR && sHour < END_HOUR) {
          if (requiredHourHeight > hourRowHeights[sHour]) {
              hourRowHeights[sHour] = requiredHourHeight;
          }
      }
  });

  drawTimeAxis(timeAxisId);
  container.innerHTML = "";
  
  // 3. 各時間のY座標（開始位置）を計算
  const hourTops = {};
  let currentTop = 0;
  for(let h=START_HOUR; h<END_HOUR; h++) {
      hourTops[h] = currentTop;
      currentTop += hourRowHeights[h];
  }
  hourTops[END_HOUR] = currentTop;

  // 4. 描画処理
  targetRooms.forEach(room => {
    const col = document.createElement('div');
    col.className = 'room-col';
    if(mode === 'single') col.style.width = "100%"; 
    const header = document.createElement('div');
    header.className = 'room-header';
    header.innerText = room.roomName;
    col.appendChild(header);
    
    const body = document.createElement('div');
    body.className = 'room-grid-body';
    body.style.height = currentTop + "px"; 

    // グリッド線
    for(let h=START_HOUR; h<END_HOUR; h++) {
        const slot = document.createElement('div');
        slot.className = 'grid-slot';
        slot.style.height = hourRowHeights[h] + "px";
        body.appendChild(slot);
    }
    
    body.onclick = (e) => {
       if (e.target.closest('.v-booking-bar')) return;
       if(e.target.classList.contains('grid-slot') || e.target === body) {
           const rect = body.getBoundingClientRect();
           const clickY = e.clientY - rect.top;
           let clickedHour = -1;
           for(let h=START_HOUR; h<END_HOUR; h++) {
               if (clickY >= hourTops[h] && clickY < hourTops[h+1]) {
                   clickedHour = h;
                   break;
               }
           }
           if(clickedHour !== -1) openModal(null, room.roomId, clickedHour);
       }
    };

    const reservations = allRelevantReservations.filter(res => String(res._resourceId) === String(room.roomId));
    
    reservations.forEach(res => {
      const start = new Date(res._startTime);
      const end = new Date(res._endTime);
      
      let sHour = start.getHours();
      let sMin = start.getMinutes();
      let eHour = end.getHours();
      let eMin = end.getMinutes();

      if (sHour < START_HOUR) { sHour = START_HOUR; sMin = 0; }
      if (eHour >= END_HOUR) { eHour = END_HOUR; eMin = 0; }
      
      if (sHour < END_HOUR && (sHour > START_HOUR || (sHour === START_HOUR && sMin >= 0))) {
          
          const topPx = hourTops[sHour] + (hourRowHeights[sHour] * (sMin / 60));
          
          let bottomPx = 0;
          if (eHour === END_HOUR) {
              bottomPx = hourTops[END_HOUR];
          } else {
              bottomPx = hourTops[eHour] + (hourRowHeights[eHour] * (eMin / 60));
          }
          
          const heightPx = bottomPx - topPx;

          const bar = document.createElement('div');
          bar.className = `v-booking-bar type-${room.type}`;
          
          bar.style.top = (topPx + 1) + "px";
          // 枠からはみ出さないように高さを微調整 (-2px)
          bar.style.height = (heightPx - 2) + "px"; 
          
          let displayTitle = getVal(res, ['title', 'subject', '件名', 'タイトル']) || '予約';
          let pNames = "";
          
          const pIdsStr = getVal(res, ['participantIds', 'participant_ids', '参加者', 'メンバー']);
          if (pIdsStr) {
              const resIds = String(pIdsStr).split(',').map(id => id.trim()).sort();
              const matchedGroup = masterData.groups.find(grp => {
                  if (!grp.memberIds) return false;
                  const grpIds = grp.memberIds.split(',').map(id => id.trim()).sort();
                  return JSON.stringify(resIds) === JSON.stringify(grpIds);
              });
              if (matchedGroup) {
                  pNames = `(${matchedGroup.groupName})`;
              } else {
                  const names = resIds.map(id => {
                      // 【描画時もID照合を強化】
                      const u = masterData.users.find(user => {
                          const uIdStr = String(user.userId);
                          return uIdStr === id || (!isNaN(uIdStr) && !isNaN(id) && Number(uIdStr) === Number(id));
                      });
                      return u ? u.userName : "";
                  }).filter(n => n);
                  pNames = `(${names.join(', ')})`;
              }
          }

          bar.innerHTML = `
            <span style="font-weight:bold;">${pad(start.getHours())}:${pad(start.getMinutes())}</span><br>
            <span style="font-weight:bold;">${displayTitle}</span>
            ${pNames ? `<br><span style="font-size:0.7rem; opacity:0.9;">${pNames}</span>` : ''}
          `;
          
          bar.onclick = (e) => { 
              e.stopPropagation(); 
              openModal(res); 
          };
          body.appendChild(bar);
      }
    });
    col.appendChild(body);
    container.appendChild(col);
  });
}
function formatDateToNum(d) {
  if (isNaN(d.getTime())) return ""; 
  return d.getFullYear() * 10000 + (d.getMonth() + 1) * 100 + d.getDate();
}

function renderRoomSearch() { renderVerticalTimeline('single'); }

function changeDate(days, inputId) {
  const input = document.getElementById(inputId);
  const d = new Date(input.value);
  d.setDate(d.getDate() + days);
  input.valueAsDate = d;
  if(inputId === 'timeline-date') renderVerticalTimeline('all');
    else if(inputId === 'map-date') renderVerticalTimeline('map');
  else renderRoomSearch();
}

// ▼▼▼ script.js の renderLogs を修正 ▼▼▼

function renderLogs() {
  const tbody = document.getElementById('log-tbody');
  tbody.innerHTML = "";
  
  if (!masterData.logs || masterData.logs.length === 0) return;

  const logs = [...masterData.logs].reverse().slice(0, 20);
  
  // 【修正】ID解決ロジック（型変換とトリムを強化）
  const resolveName = (id) => {
    const targetIdStr = String(id).trim(); // 検索対象を文字列化してトリム
    
    const u = masterData.users.find(user => {
        const uIdStr = String(user.userId).trim();
        // 文字列として一致、または数値として一致を確認
        return uIdStr === targetIdStr || (!isNaN(uIdStr) && !isNaN(targetIdStr) && Number(uIdStr) === Number(targetIdStr));
    });
    return u ? u.userName : id;
  };

  logs.forEach(log => {
    const tr = document.createElement('tr');
    
    let rawResName = log.resourceName || '-';
    let roomDisplay = rawResName;
    let detailLines = "";

    if (rawResName.includes('\n')) {
        const parts = rawResName.split('\n');
        const roomIdPart = parts[0].trim();
        detailLines = parts.slice(1).join('<br>');
        
        const roomObj = masterData.rooms.find(r => String(r.roomId) === String(roomIdPart));
        roomDisplay = roomObj ? roomObj.roomName : roomIdPart;
    } else {
        const roomObj = masterData.rooms.find(r => String(r.roomId) === String(rawResName));
        if (roomObj) roomDisplay = roomObj.roomName;
    }

    if (detailLines) {
        // 数字の羅列を見つけて名前変換（IDの前後に余計な文字があっても対応）
        detailLines = detailLines.replace(/(\d+)/g, (match) => {
            return resolveName(match);
        });
    }

    let timeDisplay = log.timeRange || '';
    if (timeDisplay.includes(' - ')) {
        const parts = timeDisplay.split(' - ');
        if (parts[0] && parts[1]) {
            const sDate = new Date(parts[0]);
            const eDate = new Date(parts[1]);
            timeDisplay = `${sDate.getMonth()+1}/${sDate.getDate()} ${pad(sDate.getHours())}:${pad(sDate.getMinutes())} - ${pad(eDate.getHours())}:${pad(eDate.getMinutes())}`;
        }
    }

    const detailHtml = `<strong>${roomDisplay}</strong>${detailLines ? `<br><span style="font-size:0.85em; color:#666;">${detailLines}</span>` : ''}<br><span style="font-size:0.8em; color:#999;">${timeDisplay}</span>`;

    tr.innerHTML = `
      <td>${formatDate(new Date(log.timestamp))}</td>
      <td>${log.operatorName}</td>
      <td>${log.action}</td>
      <td>${detailHtml}</td>
    `;
    tbody.appendChild(tr);
  });
}

function getVal(obj, keys) {
    if(!obj) return "";
    for (const k of keys) {
        if (obj[k] !== undefined && obj[k] !== null) {
            return obj[k];
        }
    }
    return ""; 
}

// ▼▼▼ 修正版 openModal (script.js) ▼▼▼
function openModal(res = null, defaultRoomId = null, clickHour = null) {
  const modal = document.getElementById('bookingModal');
  modal.style.display = 'flex';
  
  selectedParticipantIds.clear();
  originalParticipantIds.clear(); 
  document.getElementById('shuttle-search-input').value = "";
  
  if (res) {
    document.getElementById('modal-title').innerText = "予約編集";
    document.getElementById('edit-res-id').value = res.id;
    
    // 部屋IDの解決（_resourceIdプロパティがあればそれを優先）
    const rId = res._resourceId || res.resourceId || res.roomId; 
    document.getElementById('input-room').value = rId;

    // 日時のセット
    const startObj = new Date(res._startTime || res.startTime);
    const endObj = new Date(res._endTime || res.endTime);
    
    const y = startObj.getFullYear();
    const m = ('0' + (startObj.getMonth() + 1)).slice(-2);
    const d = ('0' + startObj.getDate()).slice(-2);
    document.getElementById('input-date').value = `${y}-${m}-${d}`;

    const sh = ('0' + startObj.getHours()).slice(-2);
    const sm = ('0' + startObj.getMinutes()).slice(-2);
    const eh = ('0' + endObj.getHours()).slice(-2);
    const em = ('0' + endObj.getMinutes()).slice(-2);
    document.getElementById('input-start').value = `${sh}:${sm}`;
    document.getElementById('input-end').value = `${eh}:${em}`;
    
    // タイトル・備考のセット
    const titleVal = getVal(res, ['title', 'subject', '件名', 'タイトル', '用件', 'name']);
    document.getElementById('input-title').value = titleVal;

    const noteVal = getVal(res, ['note', 'description', '備考', 'メモ', '詳細', 'body']);
    document.getElementById('input-note').value = noteVal;
    
    // 【修正箇所】参加者の読み込み（ID照合・変換ロジックを追加）
    const pIds = getVal(res, ['participantIds', 'participant_ids', '参加者', 'メンバー']);
    if (pIds) {
        let idList = [];
        if (Array.isArray(pIds)) idList = pIds;
        else if (typeof pIds === 'string') idList = pIds.split(',');
        else if (typeof pIds === 'number') idList = [pIds];

        idList.forEach(rawId => { 
          if(rawId !== null && rawId !== undefined && String(rawId).trim() !== "") {
              const targetId = String(rawId).trim();
              
              // マスタから該当ユーザーを探す（数値・文字列の違いを吸収）
              const user = masterData.users.find(u => {
                  const uId = String(u.userId).trim();
                  return uId === targetId || (!isNaN(uId) && !isNaN(targetId) && Number(uId) === Number(targetId));
              });

              // マスタにいるなら「マスタ側の正しいID」を使う（これで "1" -> "001" に変換される）
              // いないならそのまま使う（削除されたユーザーなどのため）
              const finalId = user ? String(user.userId).trim() : targetId;

              selectedParticipantIds.add(finalId); 
              originalParticipantIds.add(finalId); 
          }
        });
    }
    document.getElementById('btn-delete').style.display = 'inline-block';

  } else {
    // 新規作成時の処理（変更なし）
    document.getElementById('modal-title').innerText = "新規予約";
    document.getElementById('edit-res-id').value = "";
    if(defaultRoomId) document.getElementById('input-room').value = defaultRoomId;
    
    let currentTabDate = "";
    const timelineDateInput = document.getElementById('timeline-date');
    const searchDateInput = document.getElementById('search-date');
    
    if(document.getElementById('view-timeline').classList.contains('active')) {
        currentTabDate = timelineDateInput.value;
    } else {
        currentTabDate = searchDateInput.value;
    }
    
    if(!currentTabDate) {
        const now = new Date();
        const y = now.getFullYear();
        const mm = ('0' + (now.getMonth() + 1)).slice(-2);
        const dd = ('0' + now.getDate()).slice(-2);
        currentTabDate = `${y}-${mm}-${dd}`;
    }
    document.getElementById('input-date').value = currentTabDate;

    const sHour = clickHour ? clickHour : 9;
    document.getElementById('input-start').value = `${pad(sHour)}:00`;
    document.getElementById('input-end').value = `${pad(sHour+1)}:00`;
    
    document.getElementById('input-title').value = "";
    document.getElementById('input-note').value = "";
    document.getElementById('btn-delete').style.display = 'none';
  }
  
  // リストを再描画して反映させる
  renderShuttleLists();
}

function closeModal() { document.getElementById('bookingModal').style.display = 'none'; }

async function saveBooking() {
  const id = document.getElementById('edit-res-id').value;
  const room = document.getElementById('input-room').value;
  const date = document.getElementById('input-date').value;
  const start = document.getElementById('input-start').value;
  const end = document.getElementById('input-end').value;
  const title = document.getElementById('input-title').value;
  
  let note = document.getElementById('input-note').value;
  
  if (start >= end) {
      alert("開始時間は終了時間より前に設定してください。");
      return;
  }

  if (id) {
      let addedNames = [];
      let removedNames = [];

      selectedParticipantIds.forEach(newId => {
          if (!originalParticipantIds.has(newId)) {
              const u = masterData.users.find(user => String(user.userId) === newId);
              if (u) addedNames.push(u.userName);
          }
      });

      originalParticipantIds.forEach(oldId => {
          if (!selectedParticipantIds.has(oldId)) {
              const u = masterData.users.find(user => String(user.userId) === oldId);
              if (u) removedNames.push(u.userName);
          }
      });

      if (addedNames.length > 0 || removedNames.length > 0) {
          let changeLog = "【変更履歴】";
          if (addedNames.length > 0) changeLog += " 追加: " + addedNames.join(", ");
          if (removedNames.length > 0) changeLog += " 削除: " + removedNames.join(", ");
          
          const now = new Date();
          const timeStr = `${now.getHours()}:${pad(now.getMinutes())}`;
          changeLog += ` (${timeStr})`;

          if (!note.includes(changeLog)) {
              note = note ? note + "\n" + changeLog : changeLog;
          }
      }
  }

  const dateSlash = date.replace(/-/g, '/');
  const startTime = `${dateSlash} ${start}`;
  const endTime = `${dateSlash} ${end}`;
  const pIds = Array.from(selectedParticipantIds).join(',');

  const action = id ? 'updateReservation' : 'createReservation';
  
  const params = {
    action: action,
    reservationId: id,
    resourceId: room,
    startTime: startTime,
    endTime: endTime,
    reserverId: currentUser.userId,
    operatorName: currentUser.userName,
    participantIds: pIds, 
    title: title,
    note: note 
  };

  const result = await callAPI(params);
  if(result.status === 'success') {
    alert("保存しました");
    closeModal();
    loadAllData();
  } else {
    alert("エラー: " + result.message);
  }
}

async function deleteBooking() {
  if(!confirm("削除しますか？")) return;
  const id = document.getElementById('edit-res-id').value;
  const params = {
    action: 'deleteReservation',
    reservationId: id,
    operatorId: currentUser.userId,
    operatorName: currentUser.userName
  };
  const result = await callAPI(params);
  if(result.status === 'success') {
    alert("削除しました");
    closeModal();
    loadAllData();
  } else {
    alert("エラー: " + result.message);
  }
}

function pad(n) { return n < 10 ? '0'+n : n; }
function formatDate(d) { return `${d.getMonth()+1}/${d.getDate()} ${pad(d.getHours())}:${pad(d.getMinutes())}`; }
function getRoomName(id) { const r = masterData.rooms.find(x => x.roomId === id); return r ? r.roomName : id; }
// マップから部屋を選択したときの処理（書き換え）
function selectRoomFromMap(element) {
  const roomId = element.getAttribute('data-room-id');
  
  // マスタデータから部屋名を取得（日本語ID対応）
  const roomObj = masterData.rooms.find(r => String(r.roomId) === String(roomId));
  
  if (!roomObj) {
    alert("エラー: 指定された部屋ID (" + roomId + ") が見つかりません。");
    return;
  }

  // グローバル変数にセット
  currentMapRoomId = roomId;

  // 表示エリアをONにする
  document.getElementById('map-timeline-section').style.display = 'block';
  
  // 部屋名を表示
  document.getElementById('map-selected-room-name').innerText = roomObj.roomName;

  // タイムラインを描画 ('map'モードで呼び出し)
  renderVerticalTimeline('map');
  
  // スマホなどで見やすいように、少しスクロールする（オプション）
  document.getElementById('map-timeline-section').scrollIntoView({behavior: 'smooth'});
}
