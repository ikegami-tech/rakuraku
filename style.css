/* ==============================================
   1. 変数定義 & 基本設定
   ============================================== */
:root {
  --primary: #2c3e50;
  --accent: #27ae60;
  --danger: #c0392b;
  --meeting-bg: #e3f2fd; --meeting-border: #2196f3;
  --reception-bg: #e8f5e9; --reception-border: #4caf50;
  --zoom-bg: #fff3e0; --zoom-border: #ff9800;
  --base-hour-height: 100px;
}

body {
  font-family: "Helvetica Neue", Arial, sans-serif;
  margin: 0;
  background: #eef1f5;
  color: #333;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

* { box-sizing: border-box; }

/* ==============================================
   2. ログイン画面
   ============================================== */
#login-screen {
  position: fixed; top: 0; left: 0;
  width: 100%; height: 100%;
  background: var(--primary);
  display: flex; justify-content: center; align-items: center;
  z-index: 2000;
}
.login-box {
  background: white; padding: 2rem;
  border-radius: 8px; width: 90%; max-width: 350px;
  text-align: center;
}

/* ==============================================
   3. フォーム要素共通
   ============================================== */
input, select, textarea {
  width: 100%; padding: 10px; margin-bottom: 10px;
  border: 1px solid #ddd; border-radius: 4px;
}
button {
  width: 100%; padding: 12px;
  border: none; border-radius: 4px;
  font-weight: bold; cursor: pointer;
}
.btn-primary { background: var(--accent); color: white; }
.btn-danger { background: var(--danger); color: white; }

/* ==============================================
   4. レイアウト (ヘッダー・タブ・メイン)
   ============================================== */
#app-screen {
  display: none; flex-direction: column;
  height: 100%; max-width: 1280px; width: 100%;
  margin: 0 auto;
  background: white; box-shadow: 0 0 20px rgba(0,0,0,0.05);
}

header {
  background: var(--primary); color: white; padding: 10px;
  display: flex; justify-content: space-between; align-items: center;
  flex-shrink: 0;
}
.user-info { 
  font-size: 0.8rem;
  display: flex;          /* 横並びにする */
  align-items: center;    /* 縦位置を中央に揃える */
}

/* ヘッダー更新ボタン */
.header-left-group {
  display: flex; align-items: center; gap: 15px;
}
.btn-header-refresh {
  background-color: #3498db; color: white;
  border: none; border-radius: 4px;
  padding: 6px 12px; font-size: 0.85rem; font-weight: bold;
  cursor: pointer; display: flex; align-items: center; gap: 5px;
  transition: background 0.2s; width: auto; line-height: 1;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn-header-refresh:hover { background-color: #2980b9; transform: translateY(-1px); }
.btn-header-refresh:active { transform: translateY(1px); }
.btn-header-refresh span { font-size: 1.2em; }

/* 更新時刻表示 */
.last-update-text {
  color: rgba(255, 255, 255, 0.9);
  font-size: 0.85rem; font-weight: 500;
  margin-left: 8px; white-space: nowrap;
}

.nav-tabs {
  display: flex; background: white; border-bottom: 1px solid #ddd;
  flex-shrink: 0;
}
.nav-item {
  flex: 1; text-align: center; padding: 12px;
  cursor: pointer; border-bottom: 3px solid transparent;
}
.nav-item.active {
  border-bottom-color: var(--accent); color: var(--accent); font-weight: bold;
}

.view-container {
  display: none; flex: 1; overflow: hidden; position: relative;
}
.view-container.active { display: flex; flex-direction: column; }

/* ローディング */
#loading {
  display: none; position: fixed; top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(255,255,255,0.8);
  z-index: 4000;
  justify-content: center; align-items: center; font-weight: bold;
}

/* ==============================================
   5. タイムライン (カレンダー)
   ============================================== */
.date-controller {
  text-align: center; padding: 10px;
  background: #f9f9f9; border-bottom: 1px solid #ddd;
  display: flex; gap: 10px; justify-content: center;
  flex-shrink: 0;
}

/* 1. 全体のコンテナ設定 */
.calendar-scroll-area {
  flex: 1; 
  width: 100%; 
  max-width: 100vw; 
  position: relative;
  display: flex;
  background: white;
  
  /* 文字選択防止 */
  user-select: none;
  -webkit-user-select: none;
}
/* ▼▼▼ 追加・修正: マップ画面下のタイムライン専用設定 ▼▼▼ */
#map-timeline-section {
  display: block !important;
  width: 100%;
  flex-shrink: 0;
  margin-top: 10px;
  /* ページ自体の余白確保 */
  padding-bottom: 50px; 
}

/* 2. マップ画面専用の高さ固定設定（ここが重要） */
#map-timeline-section .calendar-scroll-area {
  /* 画面下ギリギリにならないよう、高さを少し控えめにし、下余白を確保 */
  height: 65vh !important; 
  min-height: 400px !important;
  
  overflow: auto !important;
  border-top: 1px solid #ddd;
  border-bottom: 1px solid #ddd;
  scroll-behavior: smooth;

  /* スクロールバーがコンテンツに被らないように少しパディングを入れる */
  padding-bottom: 5px; 
  margin-bottom: 20px; 
}

.time-axis-col { 
  width: 50px; 
  flex-shrink: 0; 
  
  /* スクロールしても左に張り付く設定 */
  position: sticky; 
  left: 0; 
  z-index: 100 !important;
  
  /* 重要な修正: 背景を白にして、裏に潜り込んだ予約枠を見えなくする */
  background: #fff;
  border-right: 1px solid #ddd;
  
  /* 影をつけて境界をわかりやすくする（お好みで削除可） */
  box-shadow: 2px 0 5px rgba(0,0,0,0.05);
}

.time-axis-header { 
  height: 40px; 
  border-bottom: 1px solid #ddd; 
  background: #f9f9f9;
  
  /* 縦スクロール時に上に張り付く設定 */
  position: sticky; 
  top: 0; 
  z-index: 110 !important;
}

.time-label {
  border-bottom: 1px solid #eee;
  font-size: 0.7rem; color: #888;
  text-align: right; padding-right: 5px; padding-top: 5px;
  width: 100%;
}

.rooms-container { 
  display: flex; 
  /* 中身に合わせて横幅を確保（これを親のoverflowで切る） */
  min-width: fit-content; 
  min-height: 100px;
  flex-grow: 1; 
}

.room-col { 
  flex: 1 0 120px; min-width: 120px;
  border-right: 1px solid #eee; position: relative;
  display: flex; flex-direction: column;
  overflow: visible; z-index: 1;
}

/* 選択中の部屋の強調表示 */
.room-col.target-highlight {
  background-color: #fffde7 !important;
  border: 2px solid #f1c40f !important;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  z-index: 10;
}

/* 3. 部屋名ヘッダーの固定設定 */
.room-header { 
  height: 40px; 
  display: flex; align-items: center; justify-content: center;
  font-size: 0.8rem; font-weight: bold;
  
  /* ★これを入れるだけで固定されます */
  position: sticky !important; 
  top: 0; 
  z-index: 90 !important; 
  
  background: #fafafa; 
  border-bottom: 1px solid #ddd;
  padding: 0 5px; text-align: center; word-break: break-all;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.room-col.target-highlight .room-header {
  background-color: #f1c40f !important; color: #333;
}

.room-grid-body { position: relative; background: transparent; }
.grid-slot { 
  border-bottom: 1px solid #eee; width: 100%; position: relative;
}

/* マップタイムラインエリアの表示確保 */
#map-timeline-section {
  display: block !important;
  
  /* ★重要: ここで横幅を制限しないと画面全体が広がる */
  width: 100%; 
  max-width: 100%;
  
  flex-shrink: 0; 
  padding-bottom: 50px; 
  margin-top: 10px;
  border-top: 2px solid #ddd;
  padding-top: 10px;
  box-sizing: border-box; /* パディングを含めて100%にする */
}

#map-timeline-section .calendar-scroll-area {
  height: auto !important;
  min-height: 300px !important;
  overflow: auto !important; /* 両方向スクロール許可 */
  display: flex !important;
}
/* ==============================================
   6. 予約バー (.v-booking-bar)
   ============================================== */
/* Section 6と18の定義を統合 */
.v-booking-bar {
  position: absolute; left: 2px; right: 2px;
  border-radius: 4px;
  display: flex; 
  flex-direction: column !important; /* 縦並び強制 */
  justify-content: flex-start !important;
  align-items: flex-start !important;
  text-align: left !important;
  flex-wrap: nowrap !important;
  padding: 4px !important;
  overflow: hidden; 
  z-index: 5; cursor: pointer;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  transition: all 0.1s ease-in-out;
}
.v-booking-bar:hover {
  z-index: 20;
  box-shadow: 0 5px 10px rgba(0,0,0,0.3);
  filter: brightness(0.95);
}
/* バーの中身のテキスト制御 */
.v-booking-bar > div,
.v-booking-bar > span {
  width: 100% !important; margin: 0 !important;
  text-align: left !important;
  white-space: nowrap !important;
  overflow: hidden !important; text-overflow: ellipsis !important;
}

.type-meeting { background: var(--meeting-bg); border-top: 4px solid var(--meeting-border); }
.type-reception { background: var(--reception-bg); border-top: 4px solid var(--reception-border); }
.type-zoom { background: var(--zoom-bg); border-top: 4px solid var(--zoom-border); }

/* ==============================================
   7. ログ (リスト) 画面
   ============================================== */
.log-wrapper { overflow: auto; padding: 10px; }
.log-header-area { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.log-header-area h3 { margin: 0; }
.log-search-box input { padding: 8px; width: 200px; border: 1px solid #ccc; border-radius: 4px; }

.log-table { 
  width: 100%; border-collapse: collapse; font-size: 0.8rem; background: white; table-layout: fixed;
}
.log-table th, .log-table td { padding: 8px; border: 1px solid #eee; text-align: left; word-wrap: break-word; }
.log-table th:nth-child(1), .log-table td:nth-child(1) { width: 110px; white-space: nowrap; }
.log-table th:nth-child(2), .log-table td:nth-child(2) { width: 100px; }
.log-table th:nth-child(3), .log-table td:nth-child(3) { width: 60px; white-space: nowrap; }
.log-table th:nth-child(4), .log-table td:nth-child(4) { width: auto; }

.pagination-container { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 15px; padding-bottom: 20px; }
.page-btn { padding: 6px 12px; background-color: #fff; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; user-select: none; }
.page-btn:hover { background-color: #f0f0f0; }
.page-btn.disabled { color: #ccc; cursor: not-allowed; background-color: #f9f9f9; }
.page-info { font-size: 0.9rem; font-weight: bold; color: #555; }

/* ==============================================
   8. マップ (座席) 画面
   ============================================== */
.map-wrapper {
  padding: 10px; background: #f9f9f9;
  flex: 1; overflow-y: auto; 
  display: flex; flex-direction: column;
  align-items: center; 
  justify-content: flex-start !important; /* 上詰め */
  height: 100%; width: 100%;
}
.floor-selector {
  display: flex; gap: 5px; margin-bottom: 5px;
  width: 100%; max-width: 800px;
  justify-content: center; margin: 0 auto 5px auto;
  border-bottom: 2px solid #2c3e50; flex-shrink: 0;
}
.floor-tab {
  padding: 8px 30px; background-color: #e0e0e0;
  border: none; border-radius: 6px 6px 0 0;
  cursor: pointer; font-weight: bold; color: #7f8c8d;
  transition: all 0.2s; flex-grow: 0; margin-bottom: 0;
}
.floor-tab.active { background-color: #2c3e50; color: #ffffff; transform: translateY(2px); }
.floor-tab:hover:not(.active) { background-color: #d5d5d5; color: #333; }

/* マップコンテナ & ユニット */
#dual-map-container { 
  width: 100%; height: auto; box-sizing: border-box; 
  display: flex; justify-content: center; align-items: center !important;
  flex-shrink: 0;
}
.floor-map-unit {
  width: 100%; min-width: 0; box-sizing: border-box; display: none; margin: 0 auto;
}
.floor-map-unit.active { 
  display: flex !important; flex-direction: column; align-items: center; width: 100%;
}

/* マップ画像ラッパー */
.map-inner-wrapper {
  position: relative; line-height: 0; overflow: hidden; 
  box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-radius: 4px;
  width: fit-content !important; max-width: 95% !important; height: auto !important;
  margin: 0 auto;
}
.map-image {
  display: block; width: auto !important; max-width: 100% !important;
  height: auto !important; max-height: 50vh !important;
  object-fit: contain; margin: 0 auto;
}

/* オーバーレイ & ピン */
.overlay-layer {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  z-index: 10; pointer-events: none;
}
.map-click-area {
  position: absolute; cursor: pointer; z-index: 20; pointer-events: auto;
  display: flex !important; align-items: center !important; justify-content: center !important;
  text-align: center !important; font-size: 10px !important; font-weight: bold;
  text-shadow: 1px 1px 0 #fff, -1px -1px 0 #fff, -1px 1px 0 #fff, 1px -1px 0 #fff;
  color: #333; box-sizing: border-box;
  white-space: normal !important; word-break: break-all !important; line-height: 1.1 !important;
  background: transparent; border: none; transition: all 0.2s;
}
.map-click-area:hover {
  background: rgba(39, 174, 96, 0.5) !important; border: 2px solid #27ae60 !important; color: #333;
}
/* 部屋タイプ別ホバー色 */
.map-click-area.type-meeting:hover { background: rgba(39, 174, 96, 0.6) !important; border: 2px solid #27ae60 !important; }
.map-click-area.type-reception:hover { background: rgba(255, 165, 0, 0.6) !important; border: 2px solid orange !important; }
.map-click-area.type-z:hover { background: rgba(0, 100, 255, 0.6) !important; border: 2px solid #0064ff !important; }

/* 部屋詳細テーブル */
.detail-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
.detail-table th { text-align: left; background: #f9f9f9; padding: 10px; width: 80px; border-bottom: 1px solid #eee; color: #555; font-weight: normal; }
.detail-table td { padding: 10px; border-bottom: 1px solid #eee; }

/* PC・横長画面表示時のマップ調整 (1024px以上) */
@media (min-width: 1024px) {
  .floor-selector { display: none !important; }
  .pc-floor-title { display: none !important; }
  
  #dual-map-container { 
    width: 100%; height: auto; box-sizing: border-box; 
    display: flex; justify-content: center; align-items: flex-start !important;
    flex-shrink: 0; margin-top: 10px !important; margin-bottom: 10px !important;
  }
  .map-wrapper { justify-content: flex-start !important; }

  .floor-map-unit {
    display: flex !important; flex-direction: column; align-items: center;
    flex: 0 0 50%; width: 50%; max-width: 50%; margin-bottom: 0;
  }

  .map-inner-wrapper { width: fit-content; max-width: 95% !important; }
  .map-image { width: auto !important; max-height: 65vh !important; max-width: 100% !important; }
}

/* ==============================================
   9. モーダル & 編集フォーム
   ============================================== */
.modal {
  display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 3000;
}
.modal-content {
  background: white; padding: 20px; border-radius: 8px; width: 95%; max-width: 700px;
  max-height: 90vh; overflow-y: auto; display: flex; flex-direction: column;
}
.form-group label { font-weight: bold; font-size: 0.9rem; display: block; margin-top: 10px; }

/* メンバー選択 */
.group-header { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; margin-bottom: 5px; }
.group-chip {
  display: inline-flex; align-items: center; justify-content: center; text-align: center;
  height: 30px; min-height: 30px; padding: 0 12px; margin: 2px 4px;
  background: #e0e0e0; border: 1px solid #ccc; border-radius: 15px;
  font-size: 0.75rem; line-height: 1;
  cursor: pointer; user-select: none; transition: background 0.2s; box-sizing: border-box;
}
.group-chip:hover { background: #d5d5d5; transform: translateY(-1px); }
#group-action-area { display: flex; gap: 5px; }
#group-action-area .group-chip { font-size: 0.7rem; padding: 2px 8px; margin: 0; height: auto; }

/* シャトルボックス */
.shuttle-container { display: flex; gap: 10px; margin-top: 5px; height: 200px; }
.shuttle-box { flex: 1; border: 1px solid #ddd; border-radius: 4px; display: flex; flex-direction: column; background: #fafafa; }
.shuttle-header { background: #eee; padding: 5px 10px; font-size: 0.8rem; font-weight: bold; text-align: center; border-bottom: 1px solid #ddd; }
.shuttle-list { flex: 1; overflow-y: auto; padding: 5px; background: white; }
.shuttle-item { padding: 6px 8px; border-bottom: 1px solid #f5f5f5; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; user-select: none; }
.shuttle-item:hover { background: #f0f8ff; }
.icon-add::before { content: "＋"; color: var(--accent); margin-right: 5px; font-weight:bold; }
.icon-remove::before { content: "×"; color: var(--danger); margin-right: 5px; font-weight:bold; }
.shuttle-search { padding: 5px; border-bottom: 1px solid #ddd; }
.shuttle-search input { width: 100%; margin: 0; padding: 4px; font-size: 0.8rem; }

/* 詳細表示用 */
#detail-members {
  display: block !important; width: 100% !important; max-height: 210px !important;
  overflow-y: auto !important; background-color: transparent;
  border: none; border-bottom: 1px solid #eee; border-radius: 0; padding: 0 !important; margin-top: 5px;
}
.detail-member-item { padding: 8px 12px; border-bottom: 1px solid #eee; font-size: 14px; color: #333; line-height: 1.4; text-align: left; }
.detail-member-item:last-child { border-bottom: none; }

/* メモ入力 */
textarea#input-note {
  display: block !important; width: 100% !important; height: auto !important; min-height: 100px !important;
  padding: 10px !important; margin-bottom: 15px !important; box-sizing: border-box !important;
  font-size: 16px !important; line-height: 1.5 !important; color: #333 !important; background-color: #fff !important;
}
textarea#input-note::placeholder { color: #999 !important; opacity: 1 !important; visibility: visible !important; }

/* 予約詳細のメタ情報 */
.detail-header-wrapper {
  display: flex; justify-content: space-between; align-items: flex-end;
  border-bottom: 2px solid var(--accent); padding-bottom: 5px; margin-bottom: 15px;
}
.detail-header-wrapper .modal-header-line { border-bottom: none; padding-bottom: 0; margin-bottom: 0; margin-top: 0; }
.detail-meta-info { text-align: right; font-size: 0.75rem; color: #666; line-height: 1.4; white-space: nowrap; }

/* 備考欄スクロール */
.note-scroll-area {
  max-height: 150px; overflow-y: auto; word-break: break-all; overflow-wrap: break-word;
  white-space: pre-wrap; font-size: 0.9em; line-height: 1.5; padding-right: 5px;
}

/* ==============================================
   10. 時刻入力ピッカー (Custom Time Picker) & 時間入力調整
   ============================================== */
.time-picker-wrapper { position: relative; width: 100%; }

/* Input設定 (Section 13, 22, 24の統合) */
.time-picker-wrapper input,
#bookingModal .form-row input[type="date"],
.avail-search-row input[type="date"],
.avail-search-row input[type="time"],
.avail-search-row select {
  position: relative; z-index: 1;
  width: 100%; box-sizing: border-box; 
  height: 38px !important; padding: 4px 10px !important;
  border: 1px solid #ccc; border-radius: 4px; text-align: center;
  margin-bottom: 0 !important; font-size: 16px !important; line-height: normal !important;
}
/* ピッカーの右余白確保 */
.time-picker-wrapper input { padding-right: 40px !important; }

/* 矢印 (Section 24, 29の統合) */
.time-picker-arrow {
  position: absolute; right: 0; top: 0; width: 40px; height: 100%;
  display: flex; align-items: center; justify-content: center;
  color: #666; 
  /* ★重要: カスタムプルダウンを開くためにクリックを受け付ける必要があるため auto */
  pointer-events: auto !important; cursor: pointer;
  z-index: 5; font-size: 10px;
}
/* 透明プルダウン (Section 24) */
.time-overlay-select {
  position: absolute; right: 0; top: 0; width: 40px !important; height: 100%;
  opacity: 0; cursor: pointer; z-index: 10; display: none !important; /* カスタムドロップダウンを使うため非表示 */
}

/* カスタム時間ドロップダウン (Section 29) */
.custom-time-dropdown {
  display: none; position: absolute; top: 100%; left: 0; width: 100%;
  max-height: 200px; overflow-y: auto; background: white;
  border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 4px 15px rgba(0,0,0,0.15);
  z-index: 5000; -webkit-overflow-scrolling: touch;
}
.custom-time-dropdown.show { display: block; }
.time-option {
  padding: 12px 10px; cursor: pointer; border-bottom: 1px solid #f0f0f0;
  font-size: 16px; text-align: center; color: #333;
}
.time-option:hover { background-color: #e3f2fd; }

/* 時間範囲セパレータ */
.time-range-sep {
  height: 38px !important; display: flex; align-items: center; justify-content: center;
  font-weight: bold; padding: 0 5px; margin-bottom: 0 !important; padding-bottom: 3px;
}

/* ==============================================
   11. 空き状況検索 (Availability Search)
   ============================================== */
.avail-search-row {
  display: flex; align-items: flex-end !important; gap: 10px;
  margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee; flex-wrap: wrap;
}
.avail-input-group {
  flex: 1; min-width: 140px; display: flex; flex-direction: column;
}
.avail-input-group label {
  font-size: 0.8rem; font-weight: bold; color: #555; margin-bottom: 5px; display: block;
}
.btn-search-avail {
  height: 38px !important; padding: 0 20px !important; margin-bottom: 0 !important;
  flex-shrink: 0; font-weight: bold; margin-top: auto;
}
/* 時間入力の行 */
.avail-time-row { display: flex; align-items: flex-end; gap: 5px; flex: 1; }

/* 結果リスト */
.avail-list-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 12px; border-bottom: 1px solid #eee; transition: background 0.2s;
}
.avail-list-item:hover { background-color: #f9f9f9; }
.avail-list-item:has(.status-ng) { background-color: #e0e0e0 !important; color: #999 !important; pointer-events: none; }
.avail-room-name { font-weight: bold; font-size: 1rem; color: #333; }
.avail-room-cap { font-size: 0.8rem; color: #777; margin-top: 4px; }

/* ○ (予約可) */
.status-ok {
  font-size: 0 !important; width: auto !important; height: 45px !important;
  background: transparent !important; gap: 12px; cursor: pointer;
  display: flex !important; justify-content: center; align-items: center; margin: 0 auto; border: none !important;
}
.status-ok::before {
  content: "空き"; color: #e74c3c !important; font-size: 14px !important; font-weight: bold; white-space: nowrap;
}
.status-ok::after {
  content: "予約"; display: flex; justify-content: center; align-items: center;
  width: 70px; height: 34px; background-color: #27ae60; color: #fff;
  font-size: 14px; font-weight: bold; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); transition: all 0.2s ease;
}
.status-ok:hover::after { background-color: #219150; transform: translateY(1px); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

/* × (予約不可) */
.status-ng {
  width: 100% !important; height: 45px !important; background-color: transparent !important;
  color: #999 !important; font-size: 2.0rem !important; cursor: default;
  display: flex !important; justify-content: center; align-items: center; margin: 0 auto; border: none !important;
}

/* FAB (空室確認ボタン) */
.fab-avail-btn {
  position: fixed; bottom: 30px; right: 30px; width: 70px; height: 70px; border-radius: 50%;
  background-color: #27ae60; color: white; border: none; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  z-index: 2000; cursor: pointer; transition: all 0.2s ease;
  font-weight: bold; font-size: 13px; line-height: 1.1;
}
.fab-avail-btn:hover { background-color: #219150; transform: scale(1.1); box-shadow: 0 6px 14px rgba(0,0,0,0.4); }

/* ==============================================
   12. ユーティリティクラス
   ============================================== */
.btn-logout { width: auto; padding: 5px 10px; font-size: 0.7rem; margin-left: 10px; cursor: pointer; border:none; border-radius:4px; }
.btn-sm { padding: 5px 10px; font-size: 0.8rem; }
.btn-wide { width: 120px; font-weight: bold; }
.btn-secondary { background: #999; color: white; }

.modal-sm { max-width: 500px !important; }
.modal-md { max-width: 600px !important; }
.modal-header-line { margin-top: 0; border-bottom: 2px solid var(--accent); padding-bottom: 10px; }
.modal-top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.modal-top-bar h3 { margin: 0; }
.close-icon { font-size: 28px; font-weight: bold; color: #aaa; cursor: pointer; line-height: 1; }
.modal-footer { display: flex; gap: 10px; margin-top: 20px; justify-content: center; }
.modal-footer.justify-end { justify-content: flex-end; }
.modal-footer .btn-equal { flex: 1 !important; width: auto !important; min-width: 0 !important; justify-content: center; padding: 12px 0 !important; }

.form-row { display: flex; gap: 10px; }
.form-row.align-end { align-items: flex-end; }
.form-row.mb-15 { margin-bottom: 15px; }
.flex-1 { flex: 1; }
.flex-1-2 { flex: 1.2; }

.text-bold { font-weight: bold; }
.text-lg { font-size: 1.1em; }
.text-pre-wrap { white-space: pre-wrap; }
.text-muted { color: #666; }
.bg-selected { background: #e3f2fd; }
.bg-header-selected { background: #bbdefb; }

/* ==============================================
   13. 設定メニュー (歯車アイコン)
   ============================================== */
.settings-container { display: inline-block; position: relative; margin-left: 10px; }
.settings-icon { font-size: 1.5rem; cursor: pointer; color: white; line-height: 1; transition: transform 0.3s; user-select: none; }
.settings-icon:hover { transform: rotate(90deg); opacity: 0.8; }
.settings-dropdown-content {
  display: none; position: absolute; right: 0; top: 130%; background-color: #fff;
  min-width: 160px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); border-radius: 4px;
  z-index: 5000; overflow: hidden; border: 1px solid #ddd;
}
.settings-dropdown-content.show { display: block; animation: fadeInMenu 0.2s ease-out; }
.settings-item {
  color: #333; padding: 12px 16px; text-decoration: none; display: flex;
  align-items: center; gap: 8px; cursor: pointer; font-size: 14px;
  transition: background 0.2s; border-bottom: 1px solid #f0f0f0; white-space: nowrap;
}
.settings-item:last-child { border-bottom: none; }
.settings-item:hover { background-color: #f1f1f1; }
.logout-item { color: #c0392b; }
.settings-user-display {
  padding: 12px 16px; background-color: #f8f9fa; border-bottom: 2px solid #ddd;
  font-weight: bold; color: #2c3e50; font-size: 0.9rem;
  display: flex; align-items: center; gap: 8px; cursor: default; white-space: nowrap;
}
@keyframes fadeInMenu { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

/* ==============================================
   14. モバイル用レスポンシブ (max-width: 600px)
   ============================================== */
@media (max-width: 600px) {
  /* 設定メニュー */
  .settings-icon { font-size: 1.4rem; }
  .settings-dropdown-content { min-width: 130px; }
  .settings-item { padding: 12px; font-size: 13px; }

  /* 更新日時 */
  .last-update-text { font-size: 0.75rem; margin-left: 5px; }

  /* ヘッダー */
  .header-left-group { gap: 10px; }
  .btn-header-refresh { padding: 5px 10px; font-size: 0.75rem; }

  /* 詳細モーダル */
  .detail-header-wrapper { flex-direction: column; align-items: flex-start; }
  .detail-meta-info { text-align: left; margin-top: 5px; font-size: 0.7rem; }

  /* アプリ画面固定 */
  body { height: 100dvh; overflow: hidden; }
  #app-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100dvh; margin: 0; border-radius: 0; z-index: 100; }
   
  /* --- 日付コントローラーの修正 --- */

.date-controller {
  text-align: center;
  padding: 10px;
  background: #f9f9f9;
  border-bottom: 1px solid #ddd;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px; /* 要素同士の間隔 */
  flex-shrink: 0;
}

/* 左右のボタン (< >) */
.date-controller button {
  width: 50px !important;    /* 幅を固定 */
  height: 38px !important;   /* 高さを入力欄と合わせる */
  padding: 0 !important;
  flex: 0 0 auto !important; /* 勝手に伸びないようにする */
  font-weight: bold;
  cursor: pointer;
  margin: 0 !important;      /* 余計な余白を消す */
}

/* 中央のカレンダー入力欄 */
.date-controller input[type="date"] {
  width: 160px !important;   /* 幅を程よいサイズに固定 */
  height: 38px !important;
  padding: 5px 10px !important;
  margin: 0 !important;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 4px;
}

/* 曜日の表示エリア */
#map-date-week {
  font-weight: bold;
  font-size: 1rem;
  margin-left: 5px;
  min-width: 30px; /* 曜日が入ってもガタつかないように最低幅確保 */
}

  /* メンバー選択周り */
  .shuttle-container { flex-direction: column; height: auto; gap: 15px; }
  .shuttle-box { height: 200px; flex: none; }
  .group-container { max-height: 250px; padding: 8px; }
  .group-chip { display: inline-block; padding: 6px 10px; font-size: 12px; margin: 2px; touch-action: manipulation; }

  /* モーダルフォーム: コンテナ設定 */
  #bookingModal .form-row { display: flex !important; flex-wrap: wrap !important; align-items: flex-end !important; gap: 0 !important; }
  #bookingModal .form-row > div:nth-child(1) { flex: 1 1 100% !important; width: 100% !important; max-width: 100% !important; margin-right: 0 !important; margin-bottom: 15px !important; }
  #bookingModal .form-row > div:nth-child(2),
  #bookingModal .form-row > div:nth-child(4) { flex: 1 1 42% !important; width: auto !important; min-width: 0 !important; margin-bottom: 0 !important; }
  #bookingModal .form-row > div:nth-child(3) { flex: 0 0 auto !important; width: auto !important; min-width: 20px !important; text-align: center !important; padding-bottom: 10px !important; margin: 0 !important; }
  
  #bookingModal .form-group { display: flex !important; flex-direction: row !important; flex-wrap: nowrap !important; align-items: center !important; justify-content: flex-start !important; gap: 15px !important; margin-bottom: 15px !important; }
  #bookingModal .form-group label { flex: 0 0 auto !important; width: auto !important; margin: 0 !important; font-weight: normal !important; font-size: 16px !important; line-height: 1 !important; white-space: nowrap !important; }
  #bookingModal .form-group select#input-room { flex: 0 1 auto !important; width: auto !important; min-width: 120px !important; max-width: 100% !important; margin-bottom: 0 !important; height: 38px !important; font-size: 16px !important; }

  textarea, #bookingModal textarea#input-note { min-height: 120px !important; font-size: 16px !important; line-height: 1.5 !important; margin-bottom: 20px !important; }
  
  /* マップの予約バー（スマホ特化） */
  #rooms-container-map .v-booking-bar { justify-content: flex-start !important; padding-left: 5px !important; padding-right: 8px !important; }
  #rooms-container-map .v-booking-bar > div:first-child { flex-shrink: 0 !important; margin-right: 10px !important; width: auto !important; }
  #rooms-container-map .v-booking-bar > div:last-child { flex: 1 !important; min-width: 0 !important; }

  /* FAB */
  .fab-avail-btn { width: 60px; height: 60px; bottom: 20px; right: 20px; font-size: 11px; }

  /* 空き状況検索モーダル */
  .avail-search-row { display: flex !important; flex-direction: column !important; align-items: stretch !important; gap: 15px; }
  .avail-search-row > .avail-input-group { display: flex; flex-direction: row !important; align-items: center; justify-content: flex-start !important; width: 100% !important; margin-left: 0 !important; padding-left: 0 !important; }
  .avail-search-row > .avail-input-group label { margin-bottom: 0 !important; margin-right: 15px; white-space: nowrap; min-width: 40px; }
  .avail-search-row > .avail-input-group input { flex: 1; width: auto !important; max-width: 100%; }
  .avail-time-row { width: 100%; justify-content: space-between; }
  .avail-time-row .avail-input-group { flex: 1; min-width: 0; }

  #availabilityModal .modal-content { height: auto !important; max-height: 85vh; display: flex; flex-direction: column; transition: height 0.3s ease; }
  #availabilityModal .modal-content.modal-expanded { height: 85vh !important; }
  #availabilityModal .modal-content > div:nth-of-type(2) { padding: 10px !important; margin-bottom: 0 !important; flex-shrink: 0; }
  .avail-search-row { gap: 8px !important; }
  .btn-search-avail { margin-top: 5px !important; padding: 8px !important; width: 100%; }
  #avail-result-container { display: none; border-top: 1px solid #ddd; }
  .modal-expanded #avail-result-container { display: block; flex: 1; overflow-y: auto; min-height: 0; margin-top: 10px; }
}
/* --- 追加: ヘッダー戻るボタンとタイトルのスタイル --- */
#header-title:hover {
  opacity: 0.8;
}

.btn-header-back {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.7);
  color: white;
  border-radius: 4px;
  padding: 5px 10px;
  font-size: 0.8rem;
  cursor: pointer;
  margin-right: 15px;
  vertical-align: middle;
  transition: background 0.2s;
}
.btn-header-back:hover {
  background: rgba(255,255,255,0.2);
}
